# ç¨³å®šIDç³»ç»Ÿå®ç°æ€»ç»“ ğŸ“‹

## ğŸ¯ ä»»åŠ¡å®ŒæˆçŠ¶æ€

âœ… **å·²å®Œæˆçš„å·¥ä½œ**:

### 1. ç¨³å®šIDç”Ÿæˆç®—æ³•
- **ä½ç½®**: `src/services/PM2Service.ts` - `generateStableProjectId()` æ–¹æ³•
- **ç®—æ³•**: ä½¿ç”¨é¡¹ç›®åç§°+è·¯å¾„çš„å“ˆå¸Œç»„åˆï¼Œç¡®ä¿å”¯ä¸€æ€§å’Œä¸€è‡´æ€§
- **ç‰¹ç‚¹**:
  - åŸºäºé¡¹ç›®åç§°å’Œè·¯å¾„ç”Ÿæˆ
  - ä½¿ç”¨å“ˆå¸Œç®—æ³•ç¡®ä¿å”¯ä¸€æ€§
  - åŒ…å«é¡¹ç›®åå‰ç¼€ä¾¿äºè¯†åˆ«
  - é•¿åº¦é™åˆ¶åœ¨16å­—ç¬¦ä»¥å†…

### 2. PM2Service é›†æˆ
- **æ–°å¢æ–¹æ³•**:
  - `generateStableProjectId(projectName, projectPath)` - ç”Ÿæˆç¨³å®šID
  - `checkAndSyncPM2Status(projectName, projectPath)` - æ£€æµ‹ç°æœ‰PM2è¿›ç¨‹
- **ä¿®æ”¹æ–¹æ³•**:
  - `generateProcessName(project)` - ä½¿ç”¨ç¨³å®šIDä½œä¸ºPM2è¿›ç¨‹å
  - `generatePM2Config(project)` - é…ç½®ä¸­ä½¿ç”¨ç¨³å®šID

### 3. ProjectService é›†æˆ
- **å¯¼å…¥é¡¹ç›®** (`importProject`):
  - ä½¿ç”¨ç¨³å®šIDæ›¿ä»£éšæœºID: `PM2Service.generateStableProjectId()`
  - é›†æˆPM2çŠ¶æ€æ£€æµ‹: `PM2Service.checkAndSyncPM2Status()`
  - ç”¨æˆ·é€šçŸ¥: æ˜¾ç¤ºPM2åŒæ­¥çŠ¶æ€æ¶ˆæ¯
- **åˆ›å»ºé¡¹ç›®** (`createProject`):
  - ä½¿ç”¨ç¨³å®šIDæ›¿ä»£ `Date.now().toString()`
  - é›†æˆPM2è¿›ç¨‹æ£€æµ‹
  - æ·»åŠ ç”¨æˆ·é€šçŸ¥

### 4. è¾…åŠ©å‡½æ•°æ›´æ–°
- **æ–‡ä»¶**: `src/components/projects/useProjectOperations.ts`
- **ä¿®æ”¹**: `generateProcessName()` ä½¿ç”¨ `PM2Service.generateStableProjectId()`
- **æ–‡ä»¶**: `src/components/projects/useProjectData.ts`
- **ä¿®æ”¹**: `generateProcessName()` ä½¿ç”¨ç¨³å®šID

### 5. æµ‹è¯•éªŒè¯
- **æµ‹è¯•æ–‡ä»¶**: `test-stable-id.js`
- **éªŒè¯é¡¹ç›®**:
  - âœ… ä¸€è‡´æ€§æµ‹è¯•ï¼šç›¸åŒé¡¹ç›®ç”Ÿæˆç›¸åŒID
  - âœ… å”¯ä¸€æ€§æµ‹è¯•ï¼šä¸åŒé¡¹ç›®ç”Ÿæˆä¸åŒID
  - âœ… PM2å…¼å®¹æ€§ï¼šé‡æ–°å¯¼å…¥é¡¹ç›®èƒ½æ£€æµ‹ç°æœ‰è¿›ç¨‹

## ğŸ”§ æ ¸å¿ƒç®—æ³•è¯´æ˜

```typescript
static generateStableProjectId(projectName: string, projectPath: string): string {
  // 1. ç»„åˆåç§°å’Œè·¯å¾„ï¼Œä½¿ç”¨åˆ†éš”ç¬¦
  const combined = `${projectName}|${projectPath}`;
  
  // 2. è®¡ç®—å“ˆå¸Œå€¼ç¡®ä¿å”¯ä¸€æ€§
  let hash = 0;
  for (let i = 0; i < combined.length; i++) {
    const char = combined.charCodeAt(i);
    hash = ((hash << 5) - hash) + char;
    hash = hash & hash;
  }
  
  // 3. ç”Ÿæˆç¨³å®šIDï¼šé¡¹ç›®åå‰ç¼€ + å“ˆå¸Œ
  const cleanName = projectName.replace(/[^a-zA-Z0-9]/g, '').substring(0, 6);
  const hashString = Math.abs(hash).toString(36);
  return `${cleanName}${hashString}`.substring(0, 16);
}
```

## ğŸ¯ è§£å†³çš„é—®é¢˜

### é—®é¢˜ï¼šPM2 Zombie è¿›ç¨‹
- **åŸå› **: é¡¹ç›®åˆ é™¤é‡æ–°å¯¼å…¥æ—¶è·å¾—æ–°çš„éšæœºIDï¼ŒPM2è¿›ç¨‹åå˜åŒ–
- **åæœ**: æ—§PM2è¿›ç¨‹å˜æˆ"å­¤å„¿è¿›ç¨‹"ï¼Œæ— æ³•é€šè¿‡åº”ç”¨ç®¡ç†
- **è§£å†³**: ç¨³å®šIDç¡®ä¿ç›¸åŒé¡¹ç›®å§‹ç»ˆä½¿ç”¨ç›¸åŒçš„PM2è¿›ç¨‹å

### é—®é¢˜ï¼šçŠ¶æ€ä¸åŒæ­¥
- **åŸå› **: åº”ç”¨æ— æ³•è¯†åˆ«å·²å­˜åœ¨çš„PM2è¿›ç¨‹
- **åæœ**: çŠ¶æ€æ˜¾ç¤ºä¸å‡†ç¡®ï¼Œç”¨æˆ·å›°æƒ‘
- **è§£å†³**: `checkAndSyncPM2Status()` è‡ªåŠ¨æ£€æµ‹å¹¶åŒæ­¥çŠ¶æ€

## ğŸ”„ ç”¨æˆ·ä½“éªŒæ”¹è¿›

### å¯¼å…¥é¡¹ç›®æ—¶
```
ğŸ“¥ å¼€å§‹å¯¼å…¥é¡¹ç›®: my-app
ğŸ“‹ æ­£åœ¨åˆ†æé¡¹ç›®ç»“æ„...
ğŸ†” ç”Ÿæˆç¨³å®šé¡¹ç›®ID: myappzbhp0y (åŸºäº: my-app + /path/to/project)
ğŸ” æ£€æŸ¥æ˜¯å¦å­˜åœ¨PM2è¿›ç¨‹...
ğŸ”„ å‘ç°å·²å­˜åœ¨çš„PM2è¿›ç¨‹ (running), å·²åŒæ­¥çŠ¶æ€
âœ… é¡¹ç›®å¯¼å…¥æˆåŠŸ: my-app
```

### åˆ›å»ºé¡¹ç›®æ—¶
```
ğŸ—ï¸ å¼€å§‹åˆ›å»ºé¡¹ç›®: new-project
ğŸ†” ç”Ÿæˆé¡¹ç›®ID: newpro1x2y3z4
ğŸ” æ£€æŸ¥ç°æœ‰PM2è¿›ç¨‹...
â„¹ï¸ æœªå‘ç°ç°æœ‰PM2è¿›ç¨‹ï¼Œå°†åˆ›å»ºæ–°é¡¹ç›®
âœ… é¡¹ç›®åˆ›å»ºæˆåŠŸ: new-project
```

## ğŸ“Š æµ‹è¯•ç»“æœ

```
ğŸ§ª ç¨³å®šIDç”Ÿæˆç³»ç»Ÿæµ‹è¯•
==================================================
âœ… ä¸€è‡´æ€§æ£€æŸ¥: é€šè¿‡ (ç›¸åŒè¾“å…¥äº§ç”Ÿç›¸åŒè¾“å‡º)
âœ… å”¯ä¸€æ€§æ£€æŸ¥: é€šè¿‡ (6ä¸ªé¡¹ç›®ç”Ÿæˆ6ä¸ªä¸åŒID)
âœ… PM2å…¼å®¹æ€§: é€šè¿‡ (é‡æ–°å¯¼å…¥èƒ½æ£€æµ‹ç°æœ‰è¿›ç¨‹)
```

## ğŸš€ åç»­æ”¹è¿›å»ºè®®

1. **ç”¨æˆ·ç•Œé¢å¢å¼º**:
   - åœ¨é¡¹ç›®åˆ—è¡¨ä¸­æ˜¾ç¤ºç¨³å®šIDï¼ˆå¯é€‰ï¼‰
   - æ·»åŠ "æ¸…ç†å­¤å„¿PM2è¿›ç¨‹"åŠŸèƒ½
   - PM2çŠ¶æ€åŒæ­¥æ—¶æ˜¾ç¤ºæ›´è¯¦ç»†çš„ä¿¡æ¯

2. **é”™è¯¯å¤„ç†**:
   - PM2è¿›ç¨‹æ£€æµ‹å¤±è´¥æ—¶çš„é™çº§å¤„ç†
   - ç½‘ç»œç¯å¢ƒä¸‹çš„è¶…æ—¶å¤„ç†
   - å¤šä¸ªåŒåé¡¹ç›®çš„å†²çªè§£å†³

3. **æ€§èƒ½ä¼˜åŒ–**:
   - ç¼“å­˜PM2çŠ¶æ€æ£€æµ‹ç»“æœ
   - æ‰¹é‡å¤„ç†å¤šä¸ªé¡¹ç›®çš„çŠ¶æ€åŒæ­¥
   - åå°å®šæœŸæ¸…ç†æ— æ•ˆè¿›ç¨‹

## ğŸ‰ å®ŒæˆçŠ¶æ€

**âœ… ç¨³å®šIDç³»ç»Ÿå·²å®Œå…¨é›†æˆå¹¶æµ‹è¯•é€šè¿‡ï¼**

ç°åœ¨ç”¨æˆ·å¯ä»¥ï¼š
- å®‰å…¨åœ°åˆ é™¤å’Œé‡æ–°å¯¼å…¥é¡¹ç›®
- è‡ªåŠ¨æ£€æµ‹å’ŒåŒæ­¥ç°æœ‰PM2è¿›ç¨‹
- è·å¾—å‡†ç¡®çš„é¡¹ç›®è¿è¡ŒçŠ¶æ€æ˜¾ç¤º
- é¿å…PM2å­¤å„¿è¿›ç¨‹é—®é¢˜

**æ ¸å¿ƒç›®æ ‡è¾¾æˆ**ï¼šé¡¹ç›®åˆ é™¤â†’é‡æ–°å¯¼å…¥â†’PM2è¿›ç¨‹æ­£ç¡®è¯†åˆ«â†’çŠ¶æ€æ­£ç¡®åŒæ­¥ âœ…
